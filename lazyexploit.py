import os
import shutil

# Define the directories
source_dir = 'nmap_scans'
destination_dir = 'possible_exploits'

# Ensure the destination directory exists
if not os.path.exists(destination_dir):
    os.makedirs(destination_dir)

# Function to check if the word 'EXPLOIT' is in the file
def contains_exploit(file_path):
    with open(file_path, 'r', errors='ignore') as file:
        content = file.read()
        return 'EXPLOIT' in content

# Iterate over each file in the source directory
for file_name in os.listdir(source_dir):
    file_path = os.path.join(source_dir, file_name)
    
    # Check if it is a file (not a directory)
    if os.path.isfile(file_path):
        if contains_exploit(file_path):
            # If 'EXPLOIT' is found, move the file to the destination directory
            shutil.copy(file_path, destination_dir)
            print(f"File '{file_name}' contains 'EXPLOIT' and has been copied to '{destination_dir}'")

print("Scan complete.")
